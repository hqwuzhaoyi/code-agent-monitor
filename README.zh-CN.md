# Code Agent Monitor (CAM)

[English](README.md) | [ä¸­æ–‡](README.zh-CN.md)

è¿œç¨‹ç›‘æ§å’Œç®¡ç† AI ç¼–ç  Agentï¼Œé€šè¿‡ OpenClaw å¯¹è¯äº¤äº’ã€‚

AI ç¼–ç  Agentï¼ˆClaude Codeã€Codexã€OpenCodeï¼‰åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ç»å¸¸éœ€è¦äººå·¥è¾“å…¥â€”â€”æƒé™ç¡®è®¤ã€å†³ç­–é€‰æ‹©ã€é”™è¯¯å¤„ç†ã€‚CAM è®©ä½ å¯ä»¥é€šè¿‡ OpenClaw å¯¹è¯åœ¨æ‰‹æœºä¸Šå¤„ç†è¿™äº›è¯·æ±‚ï¼Œè€Œä¸ç”¨ä¸€ç›´å®ˆåœ¨ç”µè„‘å‰ã€‚

```
Agent éœ€è¦è¾“å…¥ â†’ CAM æ£€æµ‹ â†’ OpenClaw é€šçŸ¥ä½  â†’ ä½ å›å¤ â†’ Agent ç»§ç»­æ‰§è¡Œ
```

## ç‰¹æ€§

- **è¿œç¨‹å®¡æ‰¹** â€” é€šè¿‡ OpenClaw å¯¹è¯åœ¨æ‰‹æœºä¸Šç›‘æ§å’Œå®¡æ‰¹ Agent è¯·æ±‚
- **TUI ä»ªè¡¨ç›˜** â€” å››é¢æ¿å¸ƒå±€ï¼šAgent åˆ—è¡¨ã€ç»ˆç«¯é¢„è§ˆã€é€šçŸ¥å†å²ã€è¯¦æƒ…é¢æ¿
- **å¤š Agent æ”¯æŒ** â€” Claude Codeã€Codexã€OpenCodeï¼Œç»Ÿä¸€é€‚é…å±‚è‡ªåŠ¨æ£€æµ‹
- **AI æ™ºèƒ½æå–** â€” ä½¿ç”¨ AI ä»ç»ˆç«¯å¿«ç…§ä¸­æå–é€šçŸ¥å†…å®¹ï¼Œæ— éœ€ç¡¬ç¼–ç æ¨¡å¼
- **é£é™©è¯„ä¼°** â€” è‡ªåŠ¨è¯„ä¼° Bash å‘½ä»¤é£é™©ç­‰çº§ï¼ˆä½/ä¸­/é«˜ï¼‰ï¼Œè¾…åŠ©å®¡æ‰¹å†³ç­–
- **Agent Teams** â€” å¤š Agent ç¼–æ’ï¼Œæ”¯æŒå›¢é˜Ÿåˆ›å»ºã€ä»»åŠ¡åˆ†é…ã€è¿›åº¦è¿½è¸ª
- **é€šçŸ¥å»é‡** â€” 120 ç§’çª—å£å†… 80% ç›¸ä¼¼åº¦è‡ªåŠ¨å»é‡ï¼Œé¿å…é‡å¤æ‰“æ‰°
- **æœåŠ¡æ¨¡å¼** â€” å®‰è£…ä¸º launchd ç³»ç»ŸæœåŠ¡ï¼Œå¼€æœºè‡ªå¯ï¼ŒæŒç»­ç›‘æ§

## å…¥é—¨æ•™ç¨‹

ä»é›¶å¼€å§‹ï¼Œ10 åˆ†é’Ÿå†…å®Œæˆå®‰è£…å’Œé¦–æ¬¡ä½¿ç”¨ã€‚

### å‰ç½®è¦æ±‚

| ä¾èµ– | è¯´æ˜ |
|------|------|
| Rust å·¥å…·é“¾ | éœ€è¦ `cargo`ï¼Œå®‰è£…ï¼š`curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs \| sh` |
| tmux | CAM åœ¨ tmux ä¼šè¯ä¸­è¿è¡Œ Agentï¼ŒmacOSï¼š`brew install tmux` |
| OpenClaw | å·²å®‰è£…å¹¶é…ç½®äº†æ¶ˆæ¯æ¸ é“ï¼ˆç”¨äºæ¥æ”¶é€šçŸ¥å’Œå›å¤ï¼‰ |

### ç¬¬ä¸€æ­¥ï¼šå®‰è£… CAM

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/anthropics/code-agent-monitor.git
cd code-agent-monitor

# ç¼–è¯‘ release ç‰ˆæœ¬
cargo build --release

# å®‰è£…åˆ° PATHï¼ˆäºŒé€‰ä¸€ï¼‰
cp target/release/cam /usr/local/bin/
# æˆ–è€…æ·»åŠ åˆ°ä½ çš„ shell é…ç½®
# export PATH="$PATH:/path/to/code-agent-monitor/target/release"
```

éªŒè¯å®‰è£…ï¼š

```bash
cam --help
```

å¦‚æœä½ ä½¿ç”¨ OpenClawï¼Œè¿˜éœ€è¦å®‰è£…æ’ä»¶å’Œ Skillsï¼š

```bash
# å®‰è£… CAM æ’ä»¶
openclaw plugins install --link /path/to/code-agent-monitor/plugins/cam

# å®‰è£… Skills
mkdir -p ~/.openclaw/skills
for skill in cam agent-teams cam-notify; do
  cp -r skills/$skill ~/.openclaw/skills/
done

openclaw gateway restart
```

### ç¬¬äºŒæ­¥ï¼šé…ç½® CAMï¼ˆæ¨èä½¿ç”¨ Bootstrapï¼‰

è¿è¡Œäº¤äº’å¼é…ç½®å‘å¯¼ï¼Œè‡ªåŠ¨æ£€æµ‹ OpenClaw é…ç½®å’Œå·²å®‰è£…çš„ Agent å·¥å…·ï¼š

```bash
cam bootstrap
```

è¿™ä¸€æ­¥ä¼šè‡ªåŠ¨å®Œæˆ webhookã€AI ç›‘æ§ã€agent hooks çš„é…ç½®ã€‚å¦‚æœä½ å®‰è£…äº† OpenClawï¼Œå®ƒä¼šè‡ªåŠ¨æ£€æµ‹ gateway URLã€hook token å’Œ API providerã€‚

å…¨è‡ªåŠ¨æ¨¡å¼ï¼ˆä¸æç¤ºï¼Œä½¿ç”¨æ‰€æœ‰æ£€æµ‹åˆ°çš„é»˜è®¤å€¼ï¼‰ï¼š

```bash
cam bootstrap --auto
```

å¦‚æœä½ æ›´å–œæ¬¢æ‰‹åŠ¨é…ç½®ï¼Œè¯·æŒ‰ç…§ä¸‹é¢çš„æ­¥éª¤ 2a å’Œ 2b æ“ä½œï¼Œå¦åˆ™ç›´æ¥è·³åˆ°ç¬¬ä¸‰æ­¥ã€‚

### æ­¥éª¤ 2aï¼šé…ç½® Webhookï¼ˆæ‰‹åŠ¨ï¼‰

CAM é€šè¿‡ Webhook å°†é€šçŸ¥å‘é€åˆ° OpenClaw Gatewayï¼Œå¹¶ä½¿ç”¨ AI åˆ†æç»ˆç«¯å†…å®¹ã€‚åˆ›å»ºé…ç½®æ–‡ä»¶ï¼š

```bash
mkdir -p ~/.config/code-agent-monitor
```

ç¼–è¾‘ `~/.config/code-agent-monitor/config.json`ï¼š

```json
{
  "webhook": {
    "gateway_url": "http://localhost:18789",
    "hook_token": "your-token",
    "timeout_secs": 30
  },
  "anthropic_api_key": "sk-ant-xxx",
  "anthropic_base_url": "https://api.anthropic.com"
}
```

- `gateway_url` â€” OpenClaw Gateway åœ°å€ï¼Œé»˜è®¤æœ¬åœ° `18789` ç«¯å£
- `hook_token` â€” OpenClaw çš„ Hooks è®¤è¯ tokenï¼Œæ¥è‡ª `~/.openclaw/openclaw.json` ä¸­çš„ `hooks.token` å­—æ®µã€‚å¯ä»¥ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹ï¼š
  ```bash
  cat ~/.openclaw/openclaw.json | python3 -c "import sys,json; print(json.load(sys.stdin)['hooks']['token'])"
  ```
- `timeout_secs` â€” è¯·æ±‚è¶…æ—¶æ—¶é—´
- `anthropic_api_key`ï¼ˆæ¨èï¼‰â€” Anthropic API Keyï¼Œç”¨äº AI æ™ºèƒ½åˆ†æç»ˆç«¯å†…å®¹ã€æå– Agent é—®é¢˜ã€‚å¼ºçƒˆæ¨èé…ç½®ï¼Œå¦åˆ™é€šçŸ¥å°†ç¼ºå°‘ AI åˆ†æèƒ½åŠ›
- `anthropic_base_url` â€” Anthropic API åœ°å€ï¼Œé»˜è®¤ `https://api.anthropic.com`ï¼Œå¦‚ä½¿ç”¨ä»£ç†å¯ä¿®æ”¹

API Key ä¹Ÿå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æä¾›ï¼ˆæŒ‰ä¼˜å…ˆçº§ï¼‰ï¼š
1. é…ç½®æ–‡ä»¶ï¼ˆæ¨èï¼Œå¦‚ä¸Šï¼‰
2. ç¯å¢ƒå˜é‡ `ANTHROPIC_API_KEY`
3. `~/.anthropic/api_key`
4. `~/.openclaw/openclaw.json`

### æ­¥éª¤ 2bï¼šé…ç½® Agent Hooksï¼ˆæ‰‹åŠ¨ï¼‰

è®© Claude Code åœ¨éœ€è¦è¾“å…¥æ—¶è‡ªåŠ¨é€šçŸ¥ CAMï¼š

```bash
cam setup claude
```

è¿™æ¡å‘½ä»¤ä¼šè‡ªåŠ¨å°† hooks å†™å…¥ `~/.claude/settings.json`ï¼Œè®© CAM èƒ½æ¥æ”¶ Claude Code çš„äº‹ä»¶ï¼ˆæƒé™è¯·æ±‚ã€ç©ºé—²æç¤ºç­‰ï¼‰ã€‚

å¦‚æœä½ ä½¿ç”¨å…¶ä»– Agentï¼š

```bash
cam setup codex      # é…ç½® Codex CLI
cam setup opencode   # é…ç½® OpenCode
```

æƒ³å…ˆé¢„è§ˆå˜æ›´è€Œä¸å®é™…å†™å…¥ï¼ŸåŠ  `--dry-run`ï¼š

```bash
cam setup --dry-run claude
```

### ç¬¬ä¸‰æ­¥ï¼šå®‰è£… Watcher æœåŠ¡

Watcher æ˜¯åå°å®ˆæŠ¤è¿›ç¨‹ï¼ŒæŒç»­ç›‘æ§æ‰€æœ‰ Agent çš„ç»ˆç«¯çŠ¶æ€ã€‚å®‰è£…ä¸ºç³»ç»ŸæœåŠ¡åä¼šå¼€æœºè‡ªå¯ï¼š

```bash
# å®‰è£…ä¸º launchd æœåŠ¡ï¼ˆmacOSï¼‰
cam install

# ç¡®è®¤æœåŠ¡è¿è¡Œä¸­
cam service status
```

ä½ åº”è¯¥çœ‹åˆ°æœåŠ¡çŠ¶æ€ä¸º runningã€‚å¦‚æœéœ€è¦é‡æ–°å®‰è£…ï¼š

```bash
cam install --force
```

### ç¬¬å››æ­¥ï¼šé€šè¿‡ OpenClaw å¯åŠ¨ä½ çš„ç¬¬ä¸€ä¸ª Agent

ä¸€åˆ‡å°±ç»ªï¼ç°åœ¨æ‰“å¼€ OpenClaw å¯¹è¯ï¼Œç”¨è‡ªç„¶è¯­è¨€å¯åŠ¨ä¸€ä¸ª Agentï¼š

```
ä½ : å¸®æˆ‘åœ¨ ~/workspace/myapp å¯åŠ¨ä¸ª Claude
OpenClaw: å¥½ï¼Œå¯åŠ¨ä¸­...
          âœ… å·²å¯åŠ¨ Claude @ ~/workspace/myapp (cam-1706789012)
```

ä½ ä¹Ÿå¯ä»¥ç›´æ¥ç»™ Agent ä¸€ä¸ªä»»åŠ¡ï¼š

```
ä½ : åœ¨ ~/workspace/myapp å¯åŠ¨ Claudeï¼Œå®ç°ä¸€ä¸ª TODO åº”ç”¨
```

å…¶ä»–è‡ªç„¶è¯­è¨€ç¤ºä¾‹ï¼š

| ä½ è¯´çš„è¯ | OpenClaw æ‰§è¡Œçš„æ“ä½œ |
|---------|-------------------|
| "å¸®æˆ‘åœ¨ xxx å¯åŠ¨ä¸ª Claude" | å¯åŠ¨ Agent |
| "å¼€ä¸ª Codex è·‘ xxx é¡¹ç›®" | å¯åŠ¨ Codex Agent |
| "çœ‹çœ‹åœ¨å¹²å˜›" / "ç°åœ¨è·‘ç€ä»€ä¹ˆ" | åˆ—å‡ºè¿è¡Œä¸­çš„ Agent |
| "ç»§ç»­" / "y" / "å¥½" | å‘é€ç¡®è®¤ç»™ Agent |
| "çœ‹çœ‹è¾“å‡º" / "è¿›åº¦æ€æ ·" | æŸ¥çœ‹ Agent æ—¥å¿— |
| "åœæ‰" / "åˆ«å¹²äº†" | åœæ­¢ Agent |
| "æ¢å¤ä¹‹å‰çš„" / "ç»§ç»­ä¸Šæ¬¡çš„" | æ¢å¤å†å²ä¼šè¯ |

> ä½ ä¹Ÿå¯ä»¥ç”¨ CLI ç›´æ¥å¯åŠ¨ï¼š`cam start "å®ç°ä¸€ä¸ª TODO åº”ç”¨"`

### ç¬¬äº”æ­¥ï¼šé€šè¿‡ TUI ç›‘æ§

æ‰“å¼€ TUI ä»ªè¡¨ç›˜ï¼Œå®æ—¶æŸ¥çœ‹æ‰€æœ‰ Agent çŠ¶æ€ï¼š

```bash
cam tui
```

TUI æ˜¯å››é¢æ¿å¸ƒå±€ï¼Œä½ å¯ä»¥çœ‹åˆ° Agent åˆ—è¡¨ã€ç»ˆç«¯å®æ—¶é¢„è§ˆã€é€šçŸ¥å†å²ã€‚ç”¨ `Tab` åˆ‡æ¢é¢æ¿ï¼Œ`j/k` å¯¼èˆªï¼Œ`Enter` è¿æ¥åˆ° Agent çš„ tmux ä¼šè¯ã€‚

### ç¬¬å…­æ­¥ï¼šåœ¨ OpenClaw ä¸­æ¥æ”¶é€šçŸ¥å¹¶å›å¤

å½“ Agent éœ€è¦ä½ çš„è¾“å…¥æ—¶ï¼ˆæ¯”å¦‚è¯·æ±‚æ‰§è¡Œ `rm -rf` çš„æƒé™ï¼‰ï¼ŒCAM ä¼šé€šè¿‡ Webhook å‘é€é€šçŸ¥åˆ° OpenClaw Gatewayï¼Œä½ ä¼šåœ¨ OpenClaw å¯¹è¯ä¸­æ”¶åˆ°æ¶ˆæ¯ã€‚

ç›´æ¥åœ¨å¯¹è¯ä¸­å›å¤å³å¯ï¼š
- å›å¤ `y` â€” æ‰¹å‡†è¯·æ±‚
- å›å¤ `n` â€” æ‹’ç»è¯·æ±‚
- å›å¤å…¶ä»–æ–‡æœ¬ â€” ä½œä¸ºè¾“å…¥å‘é€ç»™ Agent

ä½ ä¹Ÿå¯ä»¥åœ¨ç»ˆç«¯ä¸­å¿«é€Ÿå›å¤ï¼š

```bash
# æŸ¥çœ‹æ‰€æœ‰å¾…å¤„ç†çš„ç¡®è®¤è¯·æ±‚
cam pending-confirmations

# æ‰¹å‡†
cam reply y

# æ‰¹å‡†æ‰€æœ‰å¾…å¤„ç†è¯·æ±‚
cam reply y --all

# åªæ‰¹å‡†ä½é£é™©è¯·æ±‚
cam reply y --risk low
```

åˆ°è¿™é‡Œï¼Œä½ å·²ç»å®Œæˆäº† CAM çš„å®Œæ•´é…ç½®ã€‚Agent åœ¨åå°å·¥ä½œï¼Œéœ€è¦ä½ æ—¶æ‰‹æœºä¼šæ”¶åˆ°é€šçŸ¥ï¼Œå›å¤å³å¯ã€‚

## TUI ä»ªè¡¨ç›˜

å››é¢æ¿å¸ƒå±€ï¼Œä¸€å±æŒæ¡æ‰€æœ‰ Agent çŠ¶æ€ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Agent åˆ—è¡¨         â”‚  ç»ˆç«¯é¢„è§ˆ             â”‚
â”‚   çŠ¶æ€æŒ‡ç¤ºå™¨          â”‚  å®æ—¶ tmux æˆªå–       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   é€šçŸ¥å†å²           â”‚  é€šçŸ¥è¯¦æƒ…             â”‚
â”‚   æŒ‰ç´§æ€¥ç¨‹åº¦ç€è‰²      â”‚  é¡¹ç›®ã€é£é™©ã€å¿«ç…§      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   å¸®åŠ©æ ï¼ˆæ ¹æ®å½“å‰ç„¦ç‚¹æ˜¾ç¤ºå¿«æ·é”®ï¼‰            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

åŠŸèƒ½äº®ç‚¹ï¼š
- å®æ—¶ Agent åˆ—è¡¨ï¼ŒçŠ¶æ€æŒ‡ç¤ºå™¨ï¼ˆRunning / Idle / Errorï¼‰
- é€‰ä¸­ Agent çš„ç»ˆç«¯å®æ—¶é¢„è§ˆï¼ˆå¯æ»šåŠ¨ï¼‰
- é€šçŸ¥é¢æ¿æŒ‰ç´§æ€¥ç¨‹åº¦ç€è‰²ï¼ˆçº¢è‰²=HIGHï¼Œé»„è‰²=MEDIUMï¼Œç°è‰²=LOWï¼‰
- é€šçŸ¥è¯¦æƒ…ï¼šé¡¹ç›®åã€é£é™©ç­‰çº§ã€äº‹ä»¶è¯¦æƒ…ã€ç»ˆç«¯å¿«ç…§
- æ™ºèƒ½æ—¶é—´æ˜¾ç¤ºï¼šä»Šå¤© `HH:MM`ï¼Œæ›´æ—© `MM-DD HH:MM`
- Lazygit é£æ ¼å³æ—¶è¿‡æ»¤ï¼ˆè¾“å…¥å³è¿‡æ»¤ï¼‰
- ç„¦ç‚¹æ„ŸçŸ¥çš„é¼ æ ‡æ»šåŠ¨

å¿«æ·é”®ï¼š

| æŒ‰é”® | æ“ä½œ |
|------|------|
| `Tab` | åˆ‡æ¢é¢æ¿ç„¦ç‚¹ï¼ˆAgent åˆ—è¡¨ â†’ ç»ˆç«¯é¢„è§ˆ â†’ é€šçŸ¥è¯¦æƒ… â†’ é€šçŸ¥å†å²ï¼‰ |
| `j/k` æˆ– `â†‘/â†“` | åœ¨å½“å‰é¢æ¿ä¸­å¯¼èˆª |
| `Enter` | è¿æ¥åˆ°é€‰ä¸­ Agent çš„ tmux ä¼šè¯ |
| `x` / `d` | å…³é—­é€‰ä¸­çš„ Agent |
| `/` | è¿›å…¥è¿‡æ»¤æ¨¡å¼ï¼ˆæŒ‰ ID æˆ–é¡¹ç›®åè¿‡æ»¤ï¼‰ |
| `l` | åˆ‡æ¢åˆ°æ—¥å¿—è§†å›¾ |
| `f` | åˆ‡æ¢æ—¥å¿—çº§åˆ«è¿‡æ»¤ |
| `Esc` | æ¸…é™¤è¿‡æ»¤ / è¿”å› Agent åˆ—è¡¨ç„¦ç‚¹ |
| `?` | æ˜¾ç¤ºå¸®åŠ© |
| `q` | é€€å‡º |

## CLI å‘½ä»¤å‚è€ƒ

### Agent ç®¡ç†

| å‘½ä»¤ | è¯´æ˜ |
|------|------|
| `cam start [prompt]` | å¯åŠ¨ Agentï¼ˆæ”¯æŒ `--agent`ã€`--cwd`ã€`--resume`ï¼‰ |
| `cam list` | åˆ—å‡ºæ‰€æœ‰è¿è¡Œä¸­çš„ Agent |
| `cam kill <pid>` | ç»ˆæ­¢ Agent è¿›ç¨‹ |
| `cam resume <session_id>` | æ¢å¤å†å²ä¼šè¯ï¼ˆattach tmuxï¼‰ |
| `cam sessions` | åˆ—å‡ºæ‰€æœ‰å†å²ä¼šè¯ |

### ç›‘æ§

| å‘½ä»¤ | è¯´æ˜ |
|------|------|
| `cam tui` | å¯åŠ¨ TUI ä»ªè¡¨ç›˜ |
| `cam watch-daemon -i <ç§’>` | å¯åŠ¨åå° Watcher |
| `cam logs <session_id>` | æŸ¥çœ‹ä¼šè¯æ—¥å¿— |

### é€šçŸ¥ä¸å›å¤

| å‘½ä»¤ | è¯´æ˜ |
|------|------|
| `cam notify --event <event>` | å‘é€é€šçŸ¥äº‹ä»¶ |
| `cam watch-trigger --agent-id <id>` | æ‰‹åŠ¨è§¦å‘æ£€æµ‹ï¼ˆè°ƒè¯•ç”¨ï¼‰ |
| `cam pending-confirmations` | æŸ¥çœ‹å¾…å¤„ç†ç¡®è®¤ |
| `cam reply <response>` | å›å¤ç¡®è®¤ï¼ˆæ”¯æŒ `--all`ã€`--agent`ã€`--risk`ï¼‰ |
| `cam summary` | ç”Ÿæˆ Agent çŠ¶æ€æ±‡æ€»ï¼ˆæœ‰å¼‚å¸¸æ—¶å‘é€ï¼‰ |
| `cam summary --dry-run` | é¢„è§ˆæ±‡æ€»ï¼ˆä¸å‘é€ï¼‰ |
| `cam summary --always` | å¼ºåˆ¶å‘é€ï¼ˆæ— è®ºæ˜¯å¦æœ‰å¼‚å¸¸ï¼‰ |

### æœåŠ¡ç®¡ç†

| å‘½ä»¤ | è¯´æ˜ |
|------|------|
| `cam install` | å®‰è£… Watcher ä¸ºç³»ç»ŸæœåŠ¡ |
| `cam uninstall` | å¸è½½æœåŠ¡ |
| `cam service status` | æŸ¥çœ‹æœåŠ¡çŠ¶æ€ |
| `cam service restart` | é‡å¯æœåŠ¡ |
| `cam service logs [-f]` | æŸ¥çœ‹/è·Ÿè¸ªæœåŠ¡æ—¥å¿— |

### Agent Teams

| å‘½ä»¤ | è¯´æ˜ |
|------|------|
| `cam team-create <name>` | åˆ›å»º Team |
| `cam team-spawn <team> <name>` | åœ¨ Team ä¸­å¯åŠ¨ Agent |
| `cam team-progress <team>` | æŸ¥çœ‹ Team è¿›åº¦ |
| `cam team-shutdown <team>` | å…³é—­ Team |

### Hooks é…ç½®

| å‘½ä»¤ | è¯´æ˜ |
|------|------|
| `cam setup claude` | é…ç½® Claude Code hooks |
| `cam setup codex` | é…ç½® Codex CLI |
| `cam setup opencode` | é…ç½® OpenCode |
| `cam setup --dry-run <agent>` | é¢„è§ˆå˜æ›´ |

## é€šçŸ¥ç³»ç»Ÿ

### ç´§æ€¥ç¨‹åº¦

| çº§åˆ« | äº‹ä»¶ | è¡Œä¸º |
|------|------|------|
| HIGH | æƒé™è¯·æ±‚ã€é”™è¯¯ã€ç­‰å¾…è¾“å…¥ | ç«‹å³å‘é€ï¼Œéœ€è¦ç”¨æˆ·å›å¤ |
| MEDIUM | Agent é€€å‡ºã€ç©ºé—²æç¤º | å‘é€é€šçŸ¥ï¼Œå¯èƒ½éœ€è¦æ“ä½œ |
| LOW | ä¼šè¯å¼€å§‹ã€ç»“æŸã€å·¥å…·ä½¿ç”¨ | é™é»˜ï¼Œä¸å‘é€é€šçŸ¥ |

### å·¥ä½œåŸç†

1. **AI æ™ºèƒ½æå–** â€” AI åˆ†æç»ˆç«¯å¿«ç…§ï¼Œæå– Agent çš„é—®é¢˜å†…å®¹ï¼Œè€Œéç¡¬ç¼–ç æ­£åˆ™åŒ¹é…
2. **é£é™©è¯„ä¼°** â€” å¯¹ Bash å‘½ä»¤è¿›è¡Œä¸‰å±‚è¯„ä¼°ï¼šç™½åå•è‡ªåŠ¨é€šè¿‡ã€é»‘åå•å¿…é¡»äººå·¥ç¡®è®¤ã€å…¶ä½™ç”± AI åˆ¤æ–­
3. **é€šçŸ¥å»é‡** â€” 120 ç§’çª—å£å†…ç›¸ä¼¼åº¦è¶…è¿‡ 80% çš„é€šçŸ¥è‡ªåŠ¨åˆå¹¶
4. **ä¸Šä¸‹æ–‡æ‰©å±•** â€” å¦‚æœç»ˆç«¯å¿«ç…§ä¸å®Œæ•´ï¼Œè‡ªåŠ¨æ‰©å±•è¡Œæ•°é‡è¯•ï¼ˆ80 â†’ 150 â†’ 300 â†’ 500 â†’ 800 è¡Œï¼‰

### è‡ªåŠ¨å®¡æ‰¹

OpenClaw ä½¿ç”¨ä¸‰å±‚å†³ç­–æ¨¡å‹å¤„ç†ä½é£é™©æ“ä½œï¼š

- **ç™½åå•** â€” `ls`ã€`cat`ã€`git status`ã€`cargo test`ã€`npm test` ç­‰å®‰å…¨å‘½ä»¤è‡ªåŠ¨æ‰¹å‡†
- **é»‘åå•** â€” `rm`ã€`sudo`ã€å« `&&`ã€`|`ã€`>` çš„å‘½ä»¤å¿…é¡»äººå·¥ç¡®è®¤
- **LLM åˆ¤æ–­** â€” ä¸åœ¨åå•ä¸­çš„å‘½ä»¤ç”± AI åˆ†æé£é™©

å³ä½¿ç™½åå•å‘½ä»¤ï¼Œå¦‚æœå‚æ•°åŒ…å«æ•æ„Ÿè·¯å¾„ï¼ˆ`/etc/`ã€`~/.ssh/`ã€`.env`ï¼‰ï¼Œä»éœ€äººå·¥ç¡®è®¤ã€‚

### Agent çŠ¶æ€æ±‡æ€»

`cam summary` ç”Ÿæˆ CEO è§†è§’çš„çŠ¶æ€æ‘˜è¦å¹¶é€šè¿‡ OpenClaw å‘é€ã€‚åªåœ¨æœ‰é˜»å¡æˆ–å¼‚å¸¸æ—¶é€šçŸ¥â€”â€”ä¸€åˆ‡æ­£å¸¸åˆ™é™é»˜é€€å‡ºã€‚

```
ğŸ¤– Agent æ±‡æ€» Â· 09:30
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
æ´»è·ƒ: 3 ä¸ª  |  ç­‰å¾…å†³ç­–: 1 ä¸ª  |  å¼‚å¸¸: 0 ä¸ª

ğŸš§ éœ€è¦ä½ å†³ç­–
  cam-abc12345 Â· /workspace/auth
  â†’ æ˜¯å¦ä½¿ç”¨ JWT è¿˜æ˜¯ session-based è®¤è¯ï¼Ÿ

âœ… æœ€è¿‘è¿›å±•
  cam-def67890 Â· /workspace/api â†’ å®Œæˆäº†ç”¨æˆ·æ³¨å†Œæ¥å£
  cam-ghi11111 Â· /workspace/ui â†’ å®ç°äº†ç™»å½•è¡¨å•ç»„ä»¶
```

æ¯ä¸ª Agent çš„è¿›å±•æè¿°ç”± AIï¼ˆClaude Haikuï¼‰ä»ç»ˆç«¯å¿«ç…§ç”Ÿæˆã€‚å¤–éƒ¨ä¼šè¯ï¼ˆ`ext-*`ï¼‰è‡ªåŠ¨æ’é™¤ã€‚

å‘Šè¯‰ OpenClawï¼š`æ¯åŠå°æ—¶è°ƒç”¨ cam summary çœ‹çœ‹ agent çŠ¶æ€`

## é…ç½®

## é…ç½®

æ‰€æœ‰é…ç½®æ–‡ä»¶ä½äº `~/.config/code-agent-monitor/`ï¼š

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `config.json` | Webhook å’Œ AI ç›‘æ§é…ç½® |
| `agents.json` | è¿è¡Œä¸­çš„ Agent è®°å½• |
| `notifications.jsonl` | æœ¬åœ°é€šçŸ¥è®°å½•ï¼ˆTUI ä½¿ç”¨ï¼‰ |
| `conversation_state.json` | å¯¹è¯çŠ¶æ€ |
| `dedup_state.json` | é€šçŸ¥å»é‡çŠ¶æ€ |
| `hook.log` | Hook æ—¥å¿— |
| `watcher.pid` | Watcher è¿›ç¨‹ PID |

å®Œæ•´é…ç½®ç¤ºä¾‹ï¼ˆ`config.json`ï¼‰ï¼š

```json
{
  "webhook": {
    "gateway_url": "http://localhost:18789",
    "hook_token": "your-token",
    "timeout_secs": 30
  },
  "anthropic_api_key": "sk-ant-xxx",
  "anthropic_base_url": "https://api.anthropic.com"
}
```

## æ¶æ„æ¦‚è§ˆ

```
Claude Code Hooks â”€â”€â†’ CAM â”€â”€â†’ Webhook â”€â”€â†’ OpenClaw Gateway â”€â”€â†’ ä½ çš„æ‰‹æœº
Terminal Watcher  â”€â”€â†—        â†™
                    CAM TUI
```

CAM é€šè¿‡ä¸¤ç§æ–¹å¼æ„ŸçŸ¥ Agent çŠ¶æ€ï¼š
- **Hooks** â€” Agent ä¸»åŠ¨æ¨é€äº‹ä»¶ï¼ˆClaude Codeã€Codexã€OpenCode å„æœ‰é€‚é…å™¨ï¼‰
- **Watcher** â€” åå°è½®è¯¢ç»ˆç«¯çŠ¶æ€ï¼Œç”¨ AI åˆ¤æ–­ Agent æ˜¯å¦åœ¨ç­‰å¾…è¾“å…¥

æ‰€æœ‰é€šçŸ¥ç»Ÿä¸€é€šè¿‡ Webhook å‘é€åˆ° OpenClaw Gatewayï¼ˆ`POST /hooks/agent`ï¼‰ï¼Œè§¦å‘ OpenClaw å¯¹è¯ã€‚ç”¨æˆ·åœ¨å¯¹è¯ä¸­å›å¤åï¼ŒCAM skill é€šè¿‡ `cam reply` å°†è¾“å…¥å‘é€å› Agent çš„ tmux ä¼šè¯ã€‚

```
CAM â†’ POST /hooks/agent â†’ Gateway â†’ OpenClaw å¯¹è¯
                                        â†“
                              ç”¨æˆ·å›å¤ "y"
                                        â†“
                              CAM skill â†’ cam reply â†’ tmux send-keys
```

è¯¦ç»†æ¶æ„æ–‡æ¡£ï¼š
- [æ ¸å¿ƒæ¨¡å—](docs/architecture/core-modules.md)
- [Plugin é›†æˆ](docs/architecture/plugin-integration.md)
- [é€šçŸ¥ç³»ç»Ÿ](docs/architecture/notification-system.md)
- [Agent Teams](docs/architecture/agent-teams.md)

## å¼€å‘

```bash
# ç¼–è¯‘
cargo build --release

# è¿è¡Œæµ‹è¯•
cargo test

# é¡ºåºæ‰§è¡Œæµ‹è¯•ï¼ˆé¿å… tmux å†²çªï¼‰
cargo test -- --test-threads=1

# æ›´æ–°æ’ä»¶äºŒè¿›åˆ¶å¹¶é‡å¯æœåŠ¡
cargo build --release
cp target/release/cam plugins/cam/bin/cam
cam service restart
```

é¡¹ç›®ç»“æ„å’Œå¼€å‘æŒ‡å—è¯¦è§ [docs/development.md](docs/development.md)ã€‚

## License

MIT
